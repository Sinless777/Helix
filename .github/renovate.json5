{
  $schema: 'https://docs.renovatebot.com/renovate-schema.json',
  baseBranchPatterns: [
    'main',
  ],
  extends: [
    'config:recommended',
    ':semanticCommits',
    ':maintainLockFilesMonthly',
    ':prHourlyLimit2',
    ':label(dependencies)',
  ],
  prHourlyLimit: 2,
  labels: [
    'dependencies',
    'auto-merge',
  ],
  schedule: [
    'after 5pm every weekday',
    'every weekend',
  ],
  packageRules: [
    {
      matchManagers: [
        'pnpm',
      ],
      matchUpdateTypes: [
        'patch',
      ],
      automerge: true,
      matchPackageNames: [
        '/.*/',
      ],
      description: 'Auto-merge npm patch updates – low risk',
    },
    {
      matchManagers: [
        'npm',
      ],
      matchUpdateTypes: [
        'minor',
      ],
      automerge: false,
      description: 'Block auto-merge for npm minor updates – needs review',
    },
    {
      matchFileNames: [
        '^libs/.*\\.json$',
      ],
      enabled: false,
      matchPackageNames: [
        '/^@helix-ai/',
      ],
      description: 'Disable updates on libs JSON files for @helix-ai namespace',
    },
    {
      matchManagers: [
        'ansible-galaxy',
        'ansible',
      ],
      matchFileNames: [
        'IaC/ansible/**',
      ],
      automerge: false,
      addLabels: [
        'ansible-dependencies',
      ],
      description: 'Handle Ansible dependencies in IaC/ansible folder – manual review required',
    },
    {
      matchManagers: [
        'terraform',
      ],
      matchFileNames: [
        'IaC/terraform/**',
      ],
      automerge: false,
      addLabels: [
        'terraform-dependencies',
      ],
      groupName: 'all terraform dependencies',
      description: 'Group & label Terraform updates – manual merge, less noise',
    },
    {
      matchFileNames: [
        'IaC/kubernetes/**',
      ],
      matchManagers: [
        'helm-values',
        'kustomize',
        'helmfile',
      ],
      automerge: false,
      addLabels: [
        'k8s-dependencies',
      ],
      groupName: 'kubernetes infra updates',
      description: 'Updates for Kubernetes infra (charts, kustomize) – manual review',
    },
  ],
  ignorePaths: [
    'apps/e2e/**',
    'tools/scripts/**',
  ],
  automergeStrategy: 'merge-commit',
  rebaseWhen: 'behind-base-branch',
  onboarding: true,
  dependencyDashboard: true,
}
