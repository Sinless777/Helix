---
apiVersion: externaldns.k8s.io/v1alpha1
kind: DNSEndpoint
metadata:
  name: kube-prometheus-dns-endpoint
  namespace: network
  labels:
    app.kubernetes.io/name: kube-prometheus-dns-endpoint
    app.kubernetes.io/component: observability
    app.kubernetes.io/part-of: helix-platform
    app.kubernetes.io/managed-by: fluxcd
    helix.ai/component: observability
spec:
  endpoints:
    # ─────────────────────────────────────────────
    # Grafana — routed through external gateway
    # ─────────────────────────────────────────────
    - dnsName: grafana.${DOMAIN_3}
      recordType: CNAME
      targets:
        - external.${DOMAIN_3}

    # ─────────────────────────────────────────────
    # Prometheus — internal-only (cluster access)
    # Mapped via internal gateway (SNI routing)
    # ─────────────────────────────────────────────
    - dnsName: prometheus.${DOMAIN_3}
      recordType: CNAME
      targets:
        - internal.${DOMAIN_3}

    # ─────────────────────────────────────────────
    # Alertmanager — internal-only
    # ─────────────────────────────────────────────
    - dnsName: alertmanager.${DOMAIN_3}
      recordType: CNAME
      targets:
        - internal.${DOMAIN_3}
