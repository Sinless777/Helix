# Values for Cloudflared tunnels â€“ Helix Platform Networking

tunnels:
  - name: tunnel-1
    credentialsSecret: cloudflared-tunnel
    secretKey: tunnel_1.json
    tunnelId: "0464ceec-3629-4fa9-b945-79a5a42e7192"
    ingressHostname: "${DOMAIN_1}"
    logLevel: info
    metricsPort: 2000

  - name: tunnel-2
    credentialsSecret: cloudflared-tunnel
    secretKey: tunnel_2.json
    tunnelId: "3a16f0cd-34f9-40e1-a6fb-5913872555ad"
    ingressHostname: "${DOMAIN_2}"
    logLevel: info
    metricsPort: 2000

  - name: tunnel-3
    credentialsSecret: cloudflared-tunnel
    secretKey: tunnel_3.json
    tunnelId: "81f8d9b0-24f1-4627-9046-0714bbd1bed0"
    ingressHostname: "${DOMAIN_3}"
    logLevel: info
    metricsPort: 2000

image:
  repository: cloudflare/cloudflared
  tag: "2025.11.1"
  pullPolicy: IfNotPresent

replicaCount: 2

resources:
  requests:
    cpu: "100m"
    memory: "128Mi"
  limits:
    cpu: "200m"
    memory: "256Mi"

serviceMonitor:
  enabled: true
  namespace: networking
  interval: "1m"
  path: /metrics
  port: 2000

podAnnotations:
  prometheus.io/scrape: "true"
  prometheus.io/port: "2000"
  prometheus.io/path: "/metrics"

securityContext:
  runAsNonRoot: true
  runAsUser: 1000
  fsGroup: 1000
  allowPrivilegeEscalation: false

affinity:
  podAntiAffinity:
    requiredDuringSchedulingIgnoredDuringExecution:
      - labelSelector:
          matchLabels:
            app.kubernetes.io/name: cloudflared
        topologyKey: kubernetes.io/hostname

tolerations:
  - key: "node-role.kubernetes.io/control-plane"
    operator: "Exists"
    effect: "NoSchedule"
