apiVersion: networking.istio.io/v1
kind: DestinationRule
metadata:
  name: mesh-default
  namespace: network
  labels:
    app.kubernetes.io/name: mesh-default-destinationrule
    app.kubernetes.io/component: service-mesh
    app.kubernetes.io/part-of: helix-platform
    app.kubernetes.io/managed-by: fluxcd
    helix.ai/component: service-mesh
spec:
  host: mesh
  trafficPolicy:
    tls:
      mode: ISTIO_MUTUAL

    # Optional: Mesh-safe defaults (recommended)
    connectionPool:
      tcp:
        maxConnections: 1000
      http:
        http1MaxPendingRequests: 1000
        maxRequestsPerConnection: 100

    outlierDetection:
      consecutive5xxErrors: 5
      interval: 5s
      baseEjectionTime: 30s
      maxEjectionPercent: 50
